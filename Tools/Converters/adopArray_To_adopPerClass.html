<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>PaleoBooks - adopArray_To_adopPerClass (raw JSON to JSON)</title>
    <link rel="icon" href="./icon/160.png">
  </head>
  <body style="height:100%;">
    <table>
      <tr>
        <td>classi.json : </td>
        <td><input type="file" class="fileInput" name="classi" accept=".json, .txt"></td>
      </tr>
      <tr>
        <td>file name : </td>
        <td><input type="text" id="tableName" value="classi_"></td>
      </tr>
      <tr>
        <td colspan="2">
          <button id="btn" onclick="startConversion(true,false);">CONVERT / DOWNLOAD</button>
        </td>
      </tr>
    </table>

    <script src="base_script.js"></script>
    <script>
      //
      function shrinkJson(){
        let text = texts["classi"];
        let items;

        //console.log(text);

        if(!text) return;
        try { items = JSON.parse(text);
            } catch (e) { return; }

        //console.log(items);
        
        result.elements = {};

        for(let i=0; i<items.length; i++){
          let item = items[i];

          if( result.elements[item.BANANA] ){
            result.elements[item.BANANA].push( item );
            console.log("push");
          }else{
            console.log("add");
            result.elements[item.BANANA] = new Array();
            result.elements[item.BANANA].push( item );
          }
        }
        
        let strttt = JSON.stringify( result.elements );
        
        console.log(result.elements);
        console.log(strttt);

        download(tableName + ".json", JSON.stringify( result.elements ) );
      }

    </script>
  </body>
</html>
